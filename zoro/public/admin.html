<!DOCTYPE html>
<html>
<head>
  <title>Admin Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>#map{height:100vh;width:100%;}</style>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
<div id="map"></div>
<script>
const socket = io();
const markers = {};
const map = L.map('map').setView([0,0],2);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  attribution:'&copy; OpenStreetMap contributors'
}).addTo(map);

socket.on('userLocation',data=>{
  const {id,latitude,longitude}=data;
  if(markers[id]){
    markers[id].setLatLng([latitude,longitude]);
  }else{
    markers[id]=L.marker([latitude,longitude]).addTo(map)
      .bindPopup(`User ${id}`);
  }
});

socket.on('removeUser',id=>{
  if(markers[id]){
    map.removeLayer(markers[id]);
    delete markers[id];
  }
});
</script>
</body>
</html>





